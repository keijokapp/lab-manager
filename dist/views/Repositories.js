"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(require("react")),_semanticUiReact=require("semantic-ui-react"),_copyToClipboard=_interopRequireDefault(require("copy-to-clipboard"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class Repository extends _react.default.Component{constructor(a){super(),this.state={name:a.name,refs:a.refs,link:a.link,showMore:!1}}fetch(){this.state.loading||(this.setState({loading:"fetch"}),fetch("repository/"+encodeURIComponent(this.state.name)+"/fetch",{method:"POST"}).then(a=>{a.ok?this.reload(!0):this.setState({loading:null})}).catch(()=>{this.setState({loading:null})}))}reload(a){!a&&this.state.loading||(this.setState({loading:"reload"}),fetch("repository/"+encodeURIComponent(this.state.name)).then(a=>a.ok?a.json().then(a=>{this.setState({refs:a.refs,loading:null})}):void this.setState({loading:null})).catch(()=>{this.setState({loading:null})}))}render(){const a={};for(const b in this.state.refs){const c=this.state.refs[b];c in a?a[c].push(b):a[c]=[b]}const b=[];let c=!1;for(const d in a){const e=a[d].map(a=>_react.default.createElement(_semanticUiReact.Label,{key:a,color:"master"===a?"green":"dev"===a?"yellow":a.endsWith("-dev")?"orange":void 0,tag:!0},a)),f=_react.default.createElement("div",{key:d},_react.default.createElement(_semanticUiReact.Label,{basic:!0},d.slice(0,8))," ",e);a[d].includes("master")?(b.splice(0,0,f),c=!0):a[d].includes("dev")?b.splice(c?1:0,0,f):b.push(f)}const d=3<b.length?_react.default.createElement("div",null,_react.default.createElement("a",{href:"javascript:void(0)",onClick:()=>{this.setState({showMore:!this.state.showMore})}},this.state.showMore?"Show less":b.length-3+" more")):void 0;return _react.default.createElement(_semanticUiReact.Table.Row,{verticalAlign:"top"},_react.default.createElement(_semanticUiReact.Table.Cell,null,this.state.name),_react.default.createElement(_semanticUiReact.Table.Cell,null,this.state.showMore?b:b.slice(0,3),d),_react.default.createElement(_semanticUiReact.Table.Cell,null,_react.default.createElement(_semanticUiReact.Label,{size:"big"},this.state.link," ",_react.default.createElement(_semanticUiReact.Icon,{name:"clipboard outline",style:{cursor:"pointer",padding:"0 0 0 01em"},onClick:()=>(0,_copyToClipboard.default)(this.state.link)}))),_react.default.createElement(_semanticUiReact.Table.Cell,{collapsing:!0},_react.default.createElement(_semanticUiReact.Button,{icon:!0,color:"violet",loading:"fetch"===this.state.loading,disabled:!!this.state.loading,onClick:()=>this.fetch()},_react.default.createElement(_semanticUiReact.Icon,{name:"download"})," Fetch")),_react.default.createElement(_semanticUiReact.Table.Cell,{collapsing:!0},_react.default.createElement(_semanticUiReact.Button,{icon:!0,loading:"reload"===this.state.loading,disabled:!!this.state.loading,onClick:()=>this.reload()},_react.default.createElement(_semanticUiReact.Icon,{name:"sync alternate"}))))}}var _default=a=>{const b=a.repositories.map(a=>_react.default.createElement(Repository,{key:a._id,name:a._id,refs:a.refs,link:a.link}));return _react.default.createElement(_semanticUiReact.Grid,null,_react.default.createElement(_semanticUiReact.Grid.Column,null,_react.default.createElement(_semanticUiReact.Header,{size:"large",color:"teal"},"Repositories"),_react.default.createElement(_semanticUiReact.Table,{selectable:!0},_react.default.createElement(_semanticUiReact.Table.Header,null,_react.default.createElement(_semanticUiReact.Table.Row,null,_react.default.createElement(_semanticUiReact.Table.HeaderCell,null,"Name"),_react.default.createElement(_semanticUiReact.Table.HeaderCell,null,"Refs"),_react.default.createElement(_semanticUiReact.Table.HeaderCell,null,"Clone URL"),_react.default.createElement(_semanticUiReact.Table.HeaderCell,null),_react.default.createElement(_semanticUiReact.Table.HeaderCell,null))),_react.default.createElement(_semanticUiReact.Table.Body,null,b))))};exports.default=_default;